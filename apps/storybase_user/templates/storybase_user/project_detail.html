{% extends "twocol.html" %}

{% load i18n sekizai_tags menu_tags story projects storybase_user_tags %}

{% block head_title %}{{ project.name }}{{ block.super }}{% endblock %}

{% block body_title %}{{ project.name }}{% endblock %}

{% block content_page_class %}object-detail project{% endblock %}

{% block sidebar %}
{# TODO: Replace this with sub-nav.  The old markup looked like this: #}
{% comment %}
<nav id="subnav">
   <ul class="navroot">{% show_menu 1 %}</ul>
</nav>
{% endcomment %}
{% include "addthis_widget_small.html" %}
{% endblock %}

{% block twocol-content %}
<section class="object-summary content-block">
    <div class="grid_7 alpha">
        <section class="summary">
            {% if project.description %}
                {{ project.description|safe|linebreaks }}
            {% endif %}
        </section>
    </div>

    <div class="grid_3 omega">
        {# TODO: wire in real asset #}
        <section class="object-featured-asset">
            <img src="/static/img/image3.jpg" title="temp asset">
        </section>
    </div>
    <div class="object-metadata grid_10">
        <div class="grid_3 alpha">
        {% comment %}
        Nothing here for now. @bpawlak had put a contact address in here,
        but this doesn't make sense for projects.
        {% endcomment %}
        </div>
        <div class="grid_3">
            {% if project.members.all %}
            <h4>{% trans "Project Contributors" %}</h4>
            <ul>
                {% for member in project.members.all %}    
                <li>{% format_user_name member %}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
        <div class="grid_3 omega">
            {% if project.organizations.all %}
            <h4>{% trans "Sponsoring Organizations" %}</h4>
            <ul>
                {% for organization in project.organizations.all %}
                <li><a href="{{ organization.get_absolute_url }}">{{ organization.name }}</a></li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
    </div>
</section>
{# TODO: Implement featured stories for projects #}
{% comment %}
{% if project.featured_story %}
{% with project.featured_story as featured_story %}
<section class="featured-story content-block">
    <h3>{% trans "Featured Story" %}</h3>
    <div class="grid_2 alpha">
        <a href="#"><img src="/static/img/image3.jpg" title="temp asset" ></a>
    </div>
    <div class="grid_8 omega">
        <h4><a href="{{ featured_story.get_absolute_url }}">{{ featured_story.title }}</a></h4>
        {{ featured_story.summary|safe|linebreaks }}
    </div>
</section>
{% endwith %}
{% endif %}
{% endcomment %}
{% if project.curated_stories.all %} 
<section class="recent-stories content-block last">
    <h3>{% trans "Recent Stories" %}</h3>
    <ul>
        {% for story in project.recent_list %}
        <li>
            <div class="grid_1 alpha">
                <a href="#"><img src="/static/img/image3.jpg" title="temp asset"></a>
            </div>
            <div class="grid_9 omega">
                <h4><a href="{{ story.get_absolute_url }}">{{ story.title }}</a></h4>
                {{ story.summary|safe|linebreaks }}
            </div>
        </li>
        {% endfor %}
    </ul>
    <a class="button" href="{% url explore_stories %}?project={{ project.project_id }}">{% trans "View All Stories for This Project" %}</a>
</section>
{% endif %}
{% endblock %}

{% comment %}
        <!-- below is previous wireframe code. leaving it here temporarily in case some of the wiring is useful. -->
        <div class="content-page object-detail project container_12">
            <h2><span>Special Projects</span></h2>
            
            <div class="grid_8">
                
                <section class="object content-block">
                    <header>
                        <h3>{{ project.name }}</h3>
                        <p class="byline">{% trans "By" %} <span class="author">{{ story.byline }}</span></p>
                    </header>
                    <section class="object-featured-asset">
                        {# TODO: wire in real asset #}
                        <img src="/static/img/image3.jpg" title="temp asset">
                    </section>
                    <section class="object-summary">
                        <section class="summary">
                            {% if project.description %}
                            {{ project.description|safe|linebreaks }}
                            {% endif %}
                        </section>
                        <a id="launch-story-viewer" class="button right" href="./viewer">{% trans "View Project" %}</a>
                    </section>
                </section>
            </div>
            <div class="grid_4">
                <section class="object-summary">
                    {# just throwing a bunch of stuff in here for now #}
                    <dl class="object-metadata">
                        {% if project.website_url %}
                        <dt>Website URL</dt>
                        <dd><a href="{{ project.website_url }}">{{ project.website_url }}</a></dd>
                        {% endif %}

                        {% if project.members.count %}
                        <dt>Members</dt>
                        <dd>
                            <ul class="members">
                            {% for member in project.members.all %}
                              <li>{{ member.username }}</li>
                            {% endfor %}
                            </ul>
                        </dd>
                        {% endif %}

                        {% if project.curated_stories.count %}
                        <dt>Stories</dt>
                        <dd>
                            <ul class="stories">
                            {% for story in project.ordered_stories %}
                              <li>{{ story.title }}</li>
                            {% endfor %}
                            </ul>
                        </dd>
                        {% endif %}

                        <dt>Created</dt>
                        <dd><time class="created">{{ project.created|date:"F j, Y" }}</time></dd>

                        <dt>Last Edited</dt>
                        <dd><time class="last-edited">{{ project.last_edited|date:"F j, Y g:i A" }} </time></dd>
                    </dl>
                </section>
            </div>

            <div class=" bottom">
                <h3><span>Project Contributors</span></h3>
                {# {% placeholder project-contributors %} #}
            
                <h3><span>Supporting Organizations</span></h3>
                {# {% placeholder supporting-foundations %} #}
            </div>

        </div><!-- /.content-page -->
{% endcomment %}

{% block extrajs %}
<script src="{{ STATIC_URL }}js/libs/jquery.cycle.all.min.js"></script>
<script src="{{ STATIC_URL }}js/libs/jquery.flexslider.js" type="text/javascript"></script>
{% endblock %}
